<!DOCTYPE html>
<html>
<head>
	<title></title>
	<style>
		body { margin: 0; padding: 0; overflow: hidden; }
		body, form, label, input {background: #202125;color: white;}
		form {display: flex;flex-direction: column;max-width: 210px;align-items: flex-end;width: 100%;}
		form label {
	    	/* display: block; */
	    	font: .8rem 'Fira Sans', sans-serif;
		}

		form input {
			border: 1px solid #999;
			border-radius: 4px;
			padding: 4px;
			color: #000;
			width: 130px;
			background: #c7c7c7;
		}

		form input,
		label {
		    margin: .4rem 0 0 0;
		}

		#submit {
		margin-left: 8px;
		border: none;
		padding: 8px 24px;
		background: #0072F0;
		color: white;
		border-radius: 4px;
		width: 140px;
		}

		#success, #error {
			display: none;
			font: .8rem 'Fira Sans', sans-serif;
			align-items: center;
		}

		#success img { width: 20px; }

		#error {color: #fe66ff;}

		#loader {
			display: none;
			border: 4px solid #f3f3f3; /* Light grey */
			border-top: 4px solid #3498db; /* Blue */
			border-radius: 50%;
			width: 16px;
			height: 16px;
			animation: spin 2s linear infinite;
			margin-top FONT-VARIANT: JIS04;
		}

		@keyframes spin {
			0% { transform: rotate(0deg); }
			100% { transform: rotate(360deg); }
		}

		#gogo {
			display: flex;
			padding: 6px 0;
			flex-direction: row;
			align-items: center;
			justify-content: center;
		}

	/*	::-webkit-datetime-edit { padding: 1em; }
		::-webkit-datetime-edit-fields-wrapper { background: silver; }
		::-webkit-datetime-edit-text { color: red; padding: 0 0.3em; }
		::-webkit-datetime-edit-month-field { color: blue; }
		::-webkit-datetime-edit-day-field { color: green; }
		::-webkit-datetime-edit-year-field { color: purple; }
		::-webkit-inner-spin-button { display: none; }*/
		::-webkit-calendar-picker-indicator { color: #fff; }

	</style>
</head>
<body>
	<form action="" method="get" onsubmit="sendRange()">
	<div>
		<label for="start">Start date:</label>
		<input type="date" id="start" name="mta-start" value="" min="2021-04-08" max="2022-04-16">
	</div>
	<div>
		<label for="start">End date:</label>
		<input type="date" id="end" name="mta-end" value="" min="2021-04-08" max="2022-04-16">
	</div>
	<div id="gogo">
		<div id="loader"></div>
		<div id="error">Error!</div>
		<div id="success"><img src="check.png"></div>
		<button id="submit" value="">Calculate</button>
	<div>	
</body>
	<script type="text/javascript">

	let date = new Date().toISOString().substr(0, 10);
	console.log(date);

	document.getElementById("start").value = date;
	document.getElementById("end").value = date;

	function sendRange() {

		event.preventDefault()

		document.getElementById("loader").style.display = "block";
		document.getElementById("success").style.display = "none";
		document.getElementById("error").style.display = "none";

		let startDate = document.querySelector('input[name=mta-start]').value;
		let endDate = document.querySelector('input[name=mta-end]').value;
  		let url = "https://mta-y2u6oyxxua-ue.a.run.app/?startdate=" + startDate + "&endate=" + endDate;
		console.log(url)

		let xhttp = new XMLHttpRequest();
		xhttp.onreadystatechange = function() {
			if (this.readyState == 4 && this.status == 200) {
					document.getElementById("success").style.display = "flex";
					document.getElementById("loader").style.display = "none";
				}
			else if (this.status == 500) {
				document.getElementById("error").style.display = "flex";
				document.getElementById("loader").style.display = "none";
			}
		};
		xhttp.open("GET", url, true);
		xhttp.send();
		console.log(startDate + ' - ' + endDate);
	}

	// document.getElementById("submit").addEventListener("click", sendRange());
	</script>
</html>